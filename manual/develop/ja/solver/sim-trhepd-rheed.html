<!DOCTYPE html>

<html lang="ja" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>sim-trhepd-rheed ソルバー &#8212; 2DMAT 2.3-dev ドキュメント</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=47202671" />
    <link rel="stylesheet" type="text/css" href="../_static/haiku.css?v=dfa0e015" />
    <script src="../_static/documentation_options.js?v=d7563f6c"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/translations.js?v=91613774"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="next" title="sxrd ソルバー" href="sxrd.html" />
    <link rel="prev" title="analytical ソルバー" href="analytical.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="../index.html">
          <span>2DMAT 2.3-dev ドキュメント</span></a></h1>
        <h2 class="heading"><span>sim-trhepd-rheed ソルバー</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="Top">
      
        <p>
        «&#160;&#160;<a href="analytical.html"><code class="docutils literal notranslate"><span class="pre">analytical</span></code> ソルバー</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">コンテンツ</a>
        &#160;&#160;::&#160;&#160;
        <a href="sxrd.html"><code class="docutils literal notranslate"><span class="pre">sxrd</span></code> ソルバー</a>&#160;&#160;»
        </p>

      </div>
      <div class="content" role="main">
        
        
  <section id="sim-trhepd-rheed">
<h1><code class="docutils literal notranslate"><span class="pre">sim-trhepd-rheed</span></code> ソルバー<a class="headerlink" href="#sim-trhepd-rheed" title="Link to this heading">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">sim-trhepd-rheed</span></code> は <a class="reference external" href="https://github.com/sim-trhepd-rheed/sim-trhepd-rheed">sim-trhepd-rheed</a> を用いて原子位置 <span class="math notranslate nohighlight">\(x\)</span> から回折 rocking curve を計算し、
実験で得られた rocking curve からの誤差を <span class="math notranslate nohighlight">\(f(x)\)</span> として返す <code class="docutils literal notranslate"><span class="pre">Solver</span></code> です。</p>
<section id="id2">
<h2>前準備<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h2>
<p>あらかじめ <a class="reference external" href="https://github.com/sim-trhepd-rheed/sim-trhepd-rheed">sim-trhepd-rheed</a> をインストールしておく必要があります。</p>
<ol class="arabic simple">
<li><p>sim-trhepd-rheed の公式サイトからソースコードをダウンロード</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sim-trhepd-rheed/src</span></code> に移動し、 <code class="docutils literal notranslate"><span class="pre">make</span></code> で <code class="docutils literal notranslate"><span class="pre">bulk.exe</span></code> と <code class="docutils literal notranslate"><span class="pre">surf.exe</span></code> を作成</p></li>
</ol>
<p><code class="docutils literal notranslate"><span class="pre">py2dmat</span></code> を実行する前にあらかじめ <code class="docutils literal notranslate"><span class="pre">bulk.exe</span></code> を実行してバルクデータを作成しておきます。
<code class="docutils literal notranslate"><span class="pre">surf.exe</span></code> は <code class="docutils literal notranslate"><span class="pre">py2dmat</span></code> から呼び出されます。</p>
</section>
<section id="id3">
<h2>入力パラメータ<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">solver</span></code> セクションとセクション中のサブセクション
<code class="docutils literal notranslate"><span class="pre">config</span></code>, <code class="docutils literal notranslate"><span class="pre">post</span></code>, <code class="docutils literal notranslate"><span class="pre">param</span></code>, <code class="docutils literal notranslate"><span class="pre">reference</span></code> を利用します。</p>
<section id="solver">
<h3>[<code class="docutils literal notranslate"><span class="pre">solver</span></code>] セクション<a class="headerlink" href="#solver" title="Link to this heading">¶</a></h3>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">generate_rocking_curve</span></code></p>
<p>形式: 真偽値 (default: false)</p>
<p>説明: <code class="docutils literal notranslate"><span class="pre">RockingCurve_calculated.txt</span></code> の生成をするかどうか。 <code class="docutils literal notranslate"><span class="pre">RockingCurve_calculated.txt</span></code> は作業ディレクトリ <code class="docutils literal notranslate"><span class="pre">Log%%%_###</span></code> の中に保存されます。このオプションが&quot;true&quot;であっても、 <code class="docutils literal notranslate"><span class="pre">remove_work_dir</span></code> （[<code class="docutils literal notranslate"><span class="pre">post</span></code>] セクション）が&quot;true&quot;であれば <code class="docutils literal notranslate"><span class="pre">Log%%%_###</span></code> は削除されてしまうため、注意してください。</p>
</li>
</ul>
</section>
<section id="config">
<h3>[<code class="docutils literal notranslate"><span class="pre">config</span></code>] セクション（サブセクション）<a class="headerlink" href="#config" title="Link to this heading">¶</a></h3>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">surface_exec_file</span></code></p>
<p>形式: string型 (default: &quot;surf.exe&quot;)</p>
<p>説明: <code class="docutils literal notranslate"><span class="pre">sim-trhepd-rheed</span></code> の表面反射ソルバー <code class="docutils literal notranslate"><span class="pre">surf.exe</span></code> へのパス</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">surface_input_file</span></code></p>
<p>形式: string型 (default: &quot;surf.txt&quot;)</p>
<p>説明: 表面構造のインプットファイル。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">bulk_output_file</span></code></p>
<p>形式: string型 (default: &quot;bulkP.b&quot;)</p>
<p>説明: バルク構造のアウトプットファイル。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">surface_output_file</span></code></p>
<p>形式: string型 (default: &quot;surf-bulkP.s&quot;)</p>
<p>説明: 表面構造のアウトプットファイル。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">calculated_first_line</span></code></p>
<p>形式: 整数型 (default: 5)</p>
<p>説明: <code class="docutils literal notranslate"><span class="pre">surface_output_file</span></code> ファイル中, D(x) として読み込む最初の行。 なお、最終行は実験データとして読み込んだ行数から自動計算されます。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">calculated_info_line</span></code></p>
<p>形式: 整数型 (default: 2)</p>
<p>説明: <code class="docutils literal notranslate"><span class="pre">surface_output_file</span></code> ファイル中, glancing angle数やbeam数が記してある行番号。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">cal_number</span></code></p>
<p>形式: 整数型のリスト (設定必須)</p>
<p>説明: <code class="docutils literal notranslate"><span class="pre">surface_output_file</span></code> ファイル中, データとして読み出す列番号。複数指定が可能。設定した値は、後述の <code class="docutils literal notranslate"><span class="pre">exp_number</span></code> （[<code class="docutils literal notranslate"><span class="pre">reference</span></code>] セクション）の値とリストの長さを一致させる必要があります。</p>
</li>
</ul>
</section>
<section id="post">
<h3>[<code class="docutils literal notranslate"><span class="pre">post</span></code>] セクション（サブセクション）<a class="headerlink" href="#post" title="Link to this heading">¶</a></h3>
<p>実験と計算の「ズレ」の大きさを示し、最小化すべき関数である「目的関数」の定義や、ロッキングカーブを描くためのコンボリューション半値幅などを指定するセクションです。</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Rfactor_type</span></code></p>
<p>形式: string型。&quot;A&quot;、&quot;A2&quot;または&quot;B&quot;のいずれかをとります。 (default: &quot;A&quot;)</p>
<p>説明: 目的関数値の計算方法の指定。
視写角のインデックスを <span class="math notranslate nohighlight">\(i = 1,2,\dots,m\)</span>, ビームのインデックスを <span class="math notranslate nohighlight">\(j = 1,2,\dots,n\)</span> として、
実験・計算のデータをそれぞれ <span class="math notranslate nohighlight">\(u^{(j)}_i\)</span> と <span class="math notranslate nohighlight">\(v^{(j)}_i\)</span> で表し、
各ビームの重みを <span class="math notranslate nohighlight">\(w^{(j)}\)</span> と書くとき</p>
<blockquote>
<div><ul>
<li><p>&quot;A&quot;タイプ:</p>
<div class="math notranslate nohighlight">
\[R = \sqrt{ \sum_{j}^{n} w^{(j)} \sum_{i}^{m} \left(u^{(j)}_{i}-v^{(j)}_{i}\right)^{2} }\]</div>
</li>
<li><p>&quot;A2&quot;タイプ:</p>
<div class="math notranslate nohighlight">
\[R^{2} = \sum_{j}^{n} w^{(j)} \sum_{i}^{m} \left(u^{(j)}_{i}-v^{(j)}_{i}\right)^{2}\]</div>
</li>
<li><p>&quot;B&quot;タイプ:</p>
<div class="math notranslate nohighlight">
\[R = \frac{\sum_{i}^{m} \left(u^{(1)}_{i}-v^{(1)}_{i}\right)^{2}}{\sum_{i}^{m} \left(u^{(1)}_{i}\right)^{2} + \sum_{i}^{m} (v^{(1)}_{i})^2}\]</div>
<ul class="simple">
<li><p>&quot;B&quot;タイプはデータ列が1つの実験・計算データを用いた実行( <span class="math notranslate nohighlight">\(n=1\)</span> )のみ対応しています。</p></li>
</ul>
</li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">normalization</span></code></p>
<p>形式: string型。&quot;TOTAL&quot;または&quot;MANY_BEAM&quot;のいずれかをとります。 (設定必須)</p>
<p>説明: 実験・計算のデータベクトルの規格化の方法。</p>
<ul class="simple">
<li><p>&quot;TOTAL&quot;</p>
<ul>
<li><p>全体の和で規格化をします。</p></li>
<li><p>計算に使用するデータ列が1つのみ適用できる規格化方法であり、 <code class="docutils literal notranslate"><span class="pre">cal_number</span></code> （[<code class="docutils literal notranslate"><span class="pre">config</span></code>] セクション）および <code class="docutils literal notranslate"><span class="pre">exp_number</span></code> （[<code class="docutils literal notranslate"><span class="pre">reference</span></code>] セクション）で設定したリストの長さが1である必要が有ります。</p></li>
</ul>
</li>
<li><p>&quot;MANY_BEAM&quot;</p>
<ul>
<li><p>&quot;MANY_BEAM&quot;はデータ列が2つ以上であるときに利用できる規格化方法です。後述の <code class="docutils literal notranslate"><span class="pre">weight_type</span></code> によって規格化方法が変わります。</p></li>
</ul>
</li>
</ul>
<p><strong>なお、 normalization=&quot;MAX&quot; は廃止となりました。</strong></p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">weight_type</span></code></p>
<p>形式: string型または <code class="docutils literal notranslate"><span class="pre">None</span></code> 。&quot;calc&quot;または&quot;manual&quot;のいずれかを設定する必要があります。 (default: <code class="docutils literal notranslate"><span class="pre">None</span></code> 、 <code class="docutils literal notranslate"><span class="pre">normalization</span> <span class="pre">=</span> <span class="pre">&quot;MANY_BEAM&quot;</span></code> としたとき設定必須)</p>
<p>説明: 目的関数値を計算するときの、ビームごとの重み <span class="math notranslate nohighlight">\(w^{(j)}\)</span> の計算方法を指定します。
&quot;calc&quot;とした場合、データ列ごとの重み <span class="math notranslate nohighlight">\(w^{(n)}\)</span> は次の式で与えられます。</p>
<div class="math notranslate nohighlight">
\[w^{(j)} = \left(\frac{\sum_{i=1}^m v^{(j)}_{i}}{\sum_{k=1}^n \sum_{i=1}^m v^{(j)}_i} \right)^2\]</div>
<p>&quot;manual&quot;とした場合、オプション <code class="docutils literal notranslate"><span class="pre">spot_weight</span></code> を用いることで、ユーザーが重みを指定可能です。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">spot_weight</span></code></p>
<p>形式: float型のリスト。 (default: [] 、 <code class="docutils literal notranslate"><span class="pre">weight_type</span> <span class="pre">=</span> <span class="pre">&quot;manual&quot;</span></code> としたとき設定必須)</p>
<dl class="simple">
<dt>説明: 目的関数値を計算するときの、データ列ごとの重みを設定します。総和が1になるように自動的に規格化されます。</dt><dd><p>例えば、[3,2,1]を指定すると、 <span class="math notranslate nohighlight">\(w^{(1)}=1/2, w^{(2)}=1/3, w^{(3)}=1/6\)</span> となります。</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">omega</span></code></p>
<p>形式: 実数型 (default: 0.5)</p>
<p>説明: コンボリューションの半値幅の指定。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">remove_work_dir</span></code></p>
<p>形式: 真偽値 (default: false)</p>
<p>説明: R-factor を読み取った後に作業ディレクトリ <code class="docutils literal notranslate"><span class="pre">Log%%%_###</span></code> を削除するかどうか。なお、 <code class="docutils literal notranslate"><span class="pre">generate_rocking_curve</span></code> ([<code class="docutils literal notranslate"><span class="pre">solver</span></code>] セクション) が&quot;true&quot;であっても、本オプションが&quot;true&quot;ならば <code class="docutils literal notranslate"><span class="pre">Log%%%_###</span></code> を削除します。</p>
</li>
</ul>
</section>
<section id="param">
<h3>[<code class="docutils literal notranslate"><span class="pre">param</span></code>] セクション（サブセクション）<a class="headerlink" href="#param" title="Link to this heading">¶</a></h3>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">string_list</span></code></p>
<p>形式: string型のリスト。長さはdimensionの値と一致させます。 (default: [&quot;value_01&quot;, &quot;value_02&quot;])</p>
<p>説明: ソルバーの入力ファイルを作成するための参照用テンプレートファイルで利用するプレースホルダーのリスト。これらの文字列が探索中のパラメータの値に置換されます。</p>
</li>
</ul>
</section>
<section id="reference">
<h3>[<code class="docutils literal notranslate"><span class="pre">reference</span></code>] セクション（サブセクション）<a class="headerlink" href="#reference" title="Link to this heading">¶</a></h3>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">path</span></code></p>
<p>形式: string型 (default: <code class="docutils literal notranslate"><span class="pre">experiment.txt</span></code>)</p>
<p>説明: 実験データファイルへのパス。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">reference_first_line</span></code></p>
<p>形式: 整数型</p>
<p>説明: 実験データファイル中、実験データを読み出す最初の行の番号。省略時は1, すなわち先頭行から読み出します。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">reference_last_line</span></code></p>
<p>形式: 整数型 (default: 実験データファイルの最後の行の行数)</p>
<p>説明: 実験データファイル中、実験データを読み出す最後の行の番号。省略時は最終行まで読み出します。</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">exp_number</span></code></p>
<p>形式: 整数型のリスト</p>
<p>説明: 実験データファイル中、実験データとして読み出す列番号。複数指定が可能。設定した値は、前述の <code class="docutils literal notranslate"><span class="pre">cal_number</span></code> （[<code class="docutils literal notranslate"><span class="pre">config</span></code>] セクション）の値とリストの長さを一致させる必要があります。</p>
</li>
</ul>
</section>
</section>
<section id="id4">
<h2>ソルバー用補助ファイル<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h2>
<section id="id5">
<h3>入力テンプレートファイル<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<p>入力テンプレートファイル <code class="docutils literal notranslate"><span class="pre">template.txt</span></code> は <code class="docutils literal notranslate"><span class="pre">surf.exe</span></code> の入力ファイルを作成するためのテンプレートです。
動かすパラメータ（求めたい原子座標などの値）を「 <code class="docutils literal notranslate"><span class="pre">value_*</span></code> 」などの適当な文字列に置き換えます。
使用する文字列は入力ファイルの <code class="docutils literal notranslate"><span class="pre">[solver]</span></code> - <code class="docutils literal notranslate"><span class="pre">[param]</span></code> セクションにある、
<code class="docutils literal notranslate"><span class="pre">string_list</span></code> で指定します。
以下、テンプレートの例を記載します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span>                                    <span class="p">,</span><span class="n">NELMS</span><span class="p">,</span>  <span class="o">--------</span> <span class="n">Ge</span><span class="p">(</span><span class="mi">001</span><span class="p">)</span><span class="o">-</span><span class="n">c4x2</span>
<span class="mi">32</span><span class="p">,</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">0.15</span>                          <span class="p">,</span><span class="n">Ge</span> <span class="n">Z</span><span class="p">,</span><span class="n">da1</span><span class="p">,</span><span class="n">sap</span>
<span class="mf">0.6</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.6</span>                          <span class="p">,</span><span class="n">BH</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">BK</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">BZ</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="mi">32</span><span class="p">,</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">0.15</span>                          <span class="p">,</span><span class="n">Ge</span> <span class="n">Z</span><span class="p">,</span><span class="n">da1</span><span class="p">,</span><span class="n">sap</span>
<span class="mf">0.4</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.4</span>                          <span class="p">,</span><span class="n">BH</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">BK</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">BZ</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">1.7</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span>               <span class="p">,</span><span class="n">NSGS</span><span class="p">,</span><span class="n">msa</span><span class="p">,</span><span class="n">msb</span><span class="p">,</span><span class="n">nsa</span><span class="p">,</span><span class="n">nsb</span><span class="p">,</span><span class="n">dthick</span><span class="p">,</span><span class="n">DXS</span><span class="p">,</span><span class="n">DYS</span>
<span class="mi">8</span>                                    <span class="p">,</span><span class="n">NATM</span>
<span class="mi">1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>  <span class="n">value_01</span><span class="p">,</span>  <span class="mf">1.00000</span><span class="p">,</span>  <span class="mf">5.231000</span>   <span class="p">,</span><span class="n">IELM</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">ocr</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">Y</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">Z</span><span class="p">(</span><span class="n">I</span>
<span class="mi">1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>  <span class="n">value_02</span><span class="p">,</span>  <span class="mf">1.00000</span><span class="p">,</span>  <span class="mf">4.371000</span>
<span class="mi">2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>  <span class="mf">1.50000</span><span class="p">,</span>  <span class="mf">1.50000</span><span class="p">,</span>  <span class="mf">3.596000</span>
<span class="mi">2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>  <span class="mf">2.00000</span><span class="p">,</span>  <span class="mf">1.49751</span><span class="p">,</span>  <span class="mf">2.100000</span>
<span class="mi">2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>  <span class="mf">1.00000</span><span class="p">,</span>  <span class="mf">1.50000</span><span class="p">,</span>  <span class="mf">2.000000</span>
<span class="mi">2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>  <span class="mf">0.00000</span><span class="p">,</span>  <span class="mf">1.00000</span><span class="p">,</span>  <span class="mf">0.849425</span>
<span class="mi">2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>  <span class="mf">2.00000</span><span class="p">,</span>  <span class="mf">1.00000</span><span class="p">,</span>  <span class="mf">0.809425</span>
<span class="mi">2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>  <span class="mf">1.00997</span><span class="p">,</span>  <span class="mf">1.00000</span><span class="p">,</span>  <span class="mf">0.599425</span>
<span class="mi">1</span><span class="p">,</span><span class="mi">1</span>                                  <span class="p">,(</span><span class="n">WDOM</span><span class="p">,</span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NDOM</span><span class="p">)</span>
</pre></div>
</div>
<p>この場合、 <code class="docutils literal notranslate"><span class="pre">value_01</span></code>, <code class="docutils literal notranslate"><span class="pre">value_02</span></code>  が動かすパラメータとなります。</p>
</section>
<section id="id6">
<h3>ターゲット参照ファイル<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<p>ターゲットにするデータが格納されたファイル <code class="docutils literal notranslate"><span class="pre">experiment.txt</span></code> を指定します。
第一列に角度、第二列以降に反射強度にコンボリューションを計算した値が入ってます。
以下、ファイルの例を示します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">3.00000e-01</span> <span class="mf">8.17149e-03</span> <span class="mf">1.03057e-05</span> <span class="mf">8.88164e-15</span> <span class="o">...</span>
<span class="mf">4.00000e-01</span> <span class="mf">1.13871e-02</span> <span class="mf">4.01611e-05</span> <span class="mf">2.23952e-13</span> <span class="o">...</span>
<span class="mf">5.00000e-01</span> <span class="mf">1.44044e-02</span> <span class="mf">1.29668e-04</span> <span class="mf">4.53633e-12</span> <span class="o">...</span>
<span class="mf">6.00000e-01</span> <span class="mf">1.68659e-02</span> <span class="mf">3.49471e-04</span> <span class="mf">7.38656e-11</span> <span class="o">...</span>
<span class="mf">7.00000e-01</span> <span class="mf">1.85375e-02</span> <span class="mf">7.93037e-04</span> <span class="mf">9.67719e-10</span> <span class="o">...</span>
<span class="mf">8.00000e-01</span> <span class="mf">1.93113e-02</span> <span class="mf">1.52987e-03</span> <span class="mf">1.02117e-08</span> <span class="o">...</span>
<span class="mf">9.00000e-01</span> <span class="mf">1.92590e-02</span> <span class="mf">2.53448e-03</span> <span class="mf">8.69136e-08</span> <span class="o">...</span>
<span class="mf">1.00000e+00</span> <span class="mf">1.86780e-02</span> <span class="mf">3.64176e-03</span> <span class="mf">5.97661e-07</span> <span class="o">...</span>
<span class="mf">1.10000e+00</span> <span class="mf">1.80255e-02</span> <span class="mf">4.57932e-03</span> <span class="mf">3.32760e-06</span> <span class="o">...</span>
<span class="mf">1.20000e+00</span> <span class="mf">1.77339e-02</span> <span class="mf">5.07634e-03</span> <span class="mf">1.50410e-05</span> <span class="o">...</span>
<span class="mf">1.30000e+00</span> <span class="mf">1.80264e-02</span> <span class="mf">4.99008e-03</span> <span class="mf">5.53791e-05</span> <span class="o">...</span>
<span class="o">...</span>
</pre></div>
</div>
</section>
</section>
<section id="id7">
<h2>出力ファイル<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">sim-trhepd-rheed</span></code> では、 <code class="docutils literal notranslate"><span class="pre">surf.exe</span></code> で出力されるファイルが、
ランクの番号が記載されたフォルダ下にある <code class="docutils literal notranslate"><span class="pre">Log%%%%%_#####</span></code> フォルダに一式出力されます。
<code class="docutils literal notranslate"><span class="pre">%%%%%</span></code> はアルゴリズムの反復回数 <code class="docutils literal notranslate"><span class="pre">step</span></code> (例：モンテカルロステップ数)で、
<code class="docutils literal notranslate"><span class="pre">#####</span></code> はアルゴリズムにおけるグループの番号 <code class="docutils literal notranslate"><span class="pre">set</span></code> (例：モンテカルロにおけるレプリカ番号)です。
大規模計算ではこれらのフォルダの数が多くなり、時には計算機のストレージの制限に引っかかることがあります。
そのような場合には、 <code class="docutils literal notranslate"><span class="pre">solver.post.remove_work_dir</span></code> パラメータを <code class="docutils literal notranslate"><span class="pre">true</span></code> にして、計算が終了した作業フォルダを削除してください。
以下では、 <code class="docutils literal notranslate"><span class="pre">py2dmat</span></code> で独自に出力するファイルについて説明します。</p>
<section id="stdout">
<h3><code class="docutils literal notranslate"><span class="pre">stdout</span></code><a class="headerlink" href="#stdout" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">surf.exe</span></code> が出力する標準出力が記載されています。</p>
<p>以下、出力例です。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>bulk-filename (end=e) ? :
bulkP.b
structure-filename (end=e) ? :
surf.txt
output-filename :
surf-bulkP.s
</pre></div>
</div>
</section>
<section id="rockingcurve-calculated-txt">
<h3><code class="docutils literal notranslate"><span class="pre">RockingCurve_calculated.txt</span></code><a class="headerlink" href="#rockingcurve-calculated-txt" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">generate_rocking_curve</span></code> ([<code class="docutils literal notranslate"><span class="pre">solver</span></code>] セクション) が&quot;true&quot;の場合のみ <code class="docutils literal notranslate"><span class="pre">Log%%%%%_#####</span></code> フォルダに出力されます。</p>
<p>ファイル冒頭、 <code class="docutils literal notranslate"><span class="pre">#</span></code> で始まる行はヘッダーです。
ヘッダーには探索変数の値、目的関数値 <code class="docutils literal notranslate"><span class="pre">f(x)</span></code> オプションで指定した <code class="docutils literal notranslate"><span class="pre">Rfactor_type</span></code>,  <code class="docutils literal notranslate"><span class="pre">normalization`,</span>&#160; <span class="pre">``weight_type</span></code>,  <code class="docutils literal notranslate"><span class="pre">cal_number</span></code>, オプションで指定またはプログラムが計算したデータ列ごとの重み <code class="docutils literal notranslate"><span class="pre">spot_weight</span></code>, データ部分のどの列に何が記されているか(例： <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">#0</span> <span class="pre">glanceing_angle</span></code> など)が記されています。</p>
<p><code class="docutils literal notranslate"><span class="pre">#</span></code> が付いていない部分はデータ表記部分になります。1列目は視写角、2列目以降はデータ列ごとに強度が記しています。どのデータ列が記されているかはヘッダーの表記で確認できます。例えば</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># #0 glancing_angle</span>
<span class="c1"># #1 cal_number=1</span>
<span class="c1"># #2 cal_number=2</span>
<span class="c1"># #3 cal_number=4</span>
</pre></div>
</div>
<p>との記載があれば、1列目は視写角、2列目は計算データファイルの1列目に相当する反射強度、3列目は計算データファイルの2列目に相当する反射強度、4列目は計算データファイルの4列目に相当する反射強度が記されていることがわかります。</p>
<p>また、各列の反射強度は各列の総和が1になるように規格化されています。目的関数値（R-factor及びR-factorの二乗）を算出する際は、データ列ごとの重み <code class="docutils literal notranslate"><span class="pre">spot_weight</span></code> を加味して計算されています。</p>
<p>以下、出力例です。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#value_01 =  0.00000 value_02 =  0.00000</span>
<span class="c1">#Rfactor_type = A</span>
<span class="c1">#normalization = MANY_BEAM</span>
<span class="c1">#weight_type = manual</span>
<span class="c1">#fx(x) = 0.03686180462340505</span>
<span class="c1">#cal_number = [1, 2, 4, 6, 8]</span>
<span class="c1">#spot_weight = [0.933 0.026 0.036 0.003 0.002]</span>
<span class="c1">#NOTICE : Intensities are NOT multiplied by spot_weight.</span>
<span class="c1">#The intensity I_(spot) for each spot is normalized as in the following equation.</span>
<span class="c1">#sum( I_(spot) ) = 1</span>
<span class="c1">#</span>
<span class="c1"># #0 glancing_angle</span>
<span class="c1"># #1 cal_number=1</span>
<span class="c1"># #2 cal_number=2</span>
<span class="c1"># #3 cal_number=4</span>
<span class="c1"># #4 cal_number=6</span>
<span class="c1"># #5 cal_number=8</span>
<span class="mf">0.30000</span> <span class="mf">1.278160358686800e-02</span> <span class="mf">1.378767858296659e-04</span> <span class="mf">8.396046839668212e-14</span> <span class="mf">1.342648818357391e-30</span> <span class="mf">6.697979700048016e-53</span>
<span class="mf">0.40000</span> <span class="mf">1.778953628930054e-02</span> <span class="mf">5.281839702773564e-04</span> <span class="mf">2.108814173486245e-12</span> <span class="mf">2.467220122612354e-28</span> <span class="mf">7.252675318478533e-50</span>
<span class="mf">0.50000</span> <span class="mf">2.247181148723425e-02</span> <span class="mf">1.671115124520428e-03</span> <span class="mf">4.250758278908295e-11</span> <span class="mf">3.632860054842994e-26</span> <span class="mf">6.291667506376419e-47</span>
<span class="o">...</span>
</pre></div>
</div>
</section>
</section>
</section>


      </div>
      <div class="bottomnav" role="navigation" aria-label="Bottom">
      
        <p>
        «&#160;&#160;<a href="analytical.html"><code class="docutils literal notranslate"><span class="pre">analytical</span></code> ソルバー</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">コンテンツ</a>
        &#160;&#160;::&#160;&#160;
        <a href="sxrd.html"><code class="docutils literal notranslate"><span class="pre">sxrd</span></code> ソルバー</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
    &#169; 著作権 2020-, 2DMAT developers.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    </div>
  </body>
</html>