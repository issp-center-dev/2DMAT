<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>TRHEPD Direct Problem Solver &#8212; 2DMAT 2.3-dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/haiku.css?v=dfa0e015" />
    <script src="../_static/documentation_options.js?v=4e4c84c2"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Optimization by Nelder-Mead method" href="minsearch.html" />
    <link rel="prev" title="Tutorials" href="index.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="../index.html">
          <span>2DMAT 2.3-dev documentation</span></a></h1>
        <h2 class="heading"><span>TRHEPD Direct Problem Solver</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="Top">
      
        <p>
        «&#160;&#160;<a href="index.html">Tutorials</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="minsearch.html">Optimization by Nelder-Mead method</a>&#160;&#160;»
        </p>

      </div>
      <div class="content" role="main">
        
        
  <section id="trhepd-direct-problem-solver">
<h1>TRHEPD Direct Problem Solver<a class="headerlink" href="#trhepd-direct-problem-solver" title="Link to this heading">¶</a></h1>
<p>As one of the forward problem solvers, 2DMAT provides a wrapper for the program <a class="reference external" href="https://github.com/sim-trhepd-rheed/sim-trhepd-rheed/">sim-trhepd-rheed</a> , which calculates the intensity of reflection fast (positron) electron diffraction (RHEED, TRHEPD) (A. Ichimiya, Jpn. J. Appl. Phys. 22, 176 (1983); 24, 1365 (1985)).
In this tutorial, we will show some examples which use some algorithms with sim-trhepd-rheed.
First, we will install and test sim-trhepd-rheed (for details, see the official web page for <a class="reference external" href="https://github.com/sim-trhepd-rheed/sim-trhepd-rheed/">sim-trhepd-rheed</a>).</p>
<section id="download-and-install">
<h2>Download and Install<a class="headerlink" href="#download-and-install" title="Link to this heading">¶</a></h2>
<p>First, in the tutorial, we assume that you are at the location where the <code class="docutils literal notranslate"><span class="pre">2DMAT</span></code> folder is located.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ls -d 2DMAT
2DMAT/
</pre></div>
</div>
<p>Get the source codes from the sim-trhepd-rheed repository on GitHub and build it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">sim</span><span class="o">-</span><span class="n">trhepd</span><span class="o">-</span><span class="n">rheed</span><span class="o">/</span><span class="n">sim</span><span class="o">-</span><span class="n">trhepd</span><span class="o">-</span><span class="n">rheed</span>
<span class="n">cd</span> <span class="n">sim</span><span class="o">-</span><span class="n">trhepd</span><span class="o">-</span><span class="n">rheed</span><span class="o">/</span><span class="n">src</span>
<span class="n">make</span>
</pre></div>
</div>
<p>If make is successful, <code class="docutils literal notranslate"><span class="pre">bulk.exe</span></code> and <code class="docutils literal notranslate"><span class="pre">surf.exe</span></code> will be created.</p>
</section>
<section id="calculation-execution">
<h2>Calculation execution<a class="headerlink" href="#calculation-execution" title="Link to this heading">¶</a></h2>
<p>In sim-trhepd-rheed, the bulk part of the surface structure is first calculated with <code class="docutils literal notranslate"><span class="pre">bulk.exe</span></code>.
Then, using the results of the <code class="docutils literal notranslate"><span class="pre">bulk.exe</span></code> calculation (the <code class="docutils literal notranslate"><span class="pre">bulkP.b</span></code> file),
the surface portion of the <code class="docutils literal notranslate"><span class="pre">surf.exe</span></code> surface structure is calculated.</p>
<p>In this tutorial, we will actually try to do the TRHEPD calculation.
The sample input files are located in <code class="docutils literal notranslate"><span class="pre">sample/sim-trhepd-rheed</span></code> in 2DMAT.
First, copy this folder to a suitable working folder <code class="docutils literal notranslate"><span class="pre">work</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">../../</span>
<span class="n">cp</span> <span class="o">-</span><span class="n">r</span> <span class="mi">2</span><span class="n">DMAT</span><span class="o">/</span><span class="n">sample</span><span class="o">/</span><span class="n">sim</span><span class="o">-</span><span class="n">trhepd</span><span class="o">-</span><span class="n">rheed</span><span class="o">/</span><span class="n">solver</span> <span class="n">work</span>
<span class="n">cd</span> <span class="n">work</span>
</pre></div>
</div>
<p>Next, copy <code class="docutils literal notranslate"><span class="pre">bulk.exe</span></code> and <code class="docutils literal notranslate"><span class="pre">surf.exe</span></code> to <code class="docutils literal notranslate"><span class="pre">work</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cp</span> <span class="o">../</span><span class="n">sim</span><span class="o">-</span><span class="n">trhepd</span><span class="o">-</span><span class="n">rheed</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">bulk</span><span class="o">.</span><span class="n">exe</span> <span class="o">.</span>
<span class="n">cp</span> <span class="o">../</span><span class="n">sim</span><span class="o">-</span><span class="n">trhepd</span><span class="o">-</span><span class="n">rheed</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">surf</span><span class="o">.</span><span class="n">exe</span> <span class="o">.</span>
</pre></div>
</div>
<p>Execute <code class="docutils literal notranslate"><span class="pre">bulk.exe</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">bulk</span><span class="o">.</span><span class="n">exe</span>
</pre></div>
</div>
<p>Then, the bulk file <code class="docutils literal notranslate"><span class="pre">bulkP.b</span></code> will be generated with the following output.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>0:electron 1:positron ?
P
input-filename (end=e) ? :
bulk.txt
output-filename :
bulkP.b
</pre></div>
</div>
<p>Next, execute <code class="docutils literal notranslate"><span class="pre">surf.exe</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">surf</span><span class="o">.</span><span class="n">exe</span>
</pre></div>
</div>
<p>Then, the following standard output will be seen.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>bulk-filename (end=e) ? :
bulkP.b
structure-filename (end=e) ? :
surf.txt
output-filename :
surf-bulkP.md
surf-bulkP.s
</pre></div>
</div>
<p>After execution, the files <code class="docutils literal notranslate"><span class="pre">surf-bulkP.md</span></code>, <code class="docutils literal notranslate"><span class="pre">surf-bulkP.s</span></code> and <code class="docutils literal notranslate"><span class="pre">SURFYYYYMMDD-HHMMSSlog.txt</span></code> will be generated.
(YYYYMMDD and HHMMSS are numbers corresponding to the execution date and time).</p>
</section>
<section id="visualization-of-calculation-result">
<h2>Visualization of calculation result<a class="headerlink" href="#visualization-of-calculation-result" title="Link to this heading">¶</a></h2>
<p>The contents of <code class="docutils literal notranslate"><span class="pre">surf-bulkP.s</span></code> are shown as follow:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#azimuths,g-angles,beams</span>
<span class="mi">1</span> <span class="mi">56</span> <span class="mi">13</span>
<span class="c1">#ih,ik</span>
<span class="mi">6</span> <span class="mi">0</span> <span class="mi">5</span> <span class="mi">0</span> <span class="mi">4</span> <span class="mi">0</span> <span class="mi">3</span> <span class="mi">0</span> <span class="mi">2</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="o">-</span><span class="mi">1</span> <span class="mi">0</span> <span class="o">-</span><span class="mi">2</span> <span class="mi">0</span> <span class="o">-</span><span class="mi">3</span> <span class="mi">0</span> <span class="o">-</span><span class="mi">4</span> <span class="mi">0</span> <span class="o">-</span><span class="mi">5</span> <span class="mi">0</span> <span class="o">-</span><span class="mi">6</span> <span class="mi">0</span>
<span class="mf">0.5000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.1595E-01</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span>
<span class="mf">0.6000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.1870E-01</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span>
<span class="mf">0.7000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.2121E-01</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span>
<span class="mf">0.8000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.2171E-02</span><span class="p">,</span> <span class="mf">0.1927E-01</span><span class="p">,</span> <span class="mf">0.2171E-02</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span>
<span class="mf">0.9000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.4397E-02</span><span class="p">,</span> <span class="mf">0.1700E-01</span><span class="p">,</span> <span class="mf">0.4397E-02</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span>
<span class="mf">0.1000E+01</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.6326E-02</span><span class="p">,</span> <span class="mf">0.1495E-01</span><span class="p">,</span> <span class="mf">0.6326E-02</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span> <span class="mf">0.0000E+00</span><span class="p">,</span>
<span class="o">...</span>
</pre></div>
</div>
<p>From the above file, create a rocking curve from the angle on the vertical axis (first column of data after row 5) and the intensity of the (0,0) peak (eighth column of data after row 5).
You can use Gnuplot or other graphing software, but here we use the program <code class="docutils literal notranslate"><span class="pre">plot_bulkP.py</span></code> in the <code class="docutils literal notranslate"><span class="pre">2DMAT/script</span></code> folder.
Run it as follows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">../</span><span class="mi">2</span><span class="n">DMAT</span><span class="o">/</span><span class="n">script</span><span class="o">/</span><span class="n">plot_bulkP</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>The following <code class="docutils literal notranslate"><span class="pre">plot_bulkP.png</span></code> will be created.</p>
<figure class="align-default" id="id2">
<img alt="../_images/plot_bulkP.png" src="../_images/plot_bulkP.png" />
<figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">Rocking curve of Si(001)-2x1 surface.</span><a class="headerlink" href="#id2" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>We will convolute and normalize the diffraction intensity data of the 00 peaks.
Prepare <code class="docutils literal notranslate"><span class="pre">surf-bulkP.s</span></code> and run <code class="docutils literal notranslate"><span class="pre">make_convolution.py</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">../</span><span class="mi">2</span><span class="n">DMAT</span><span class="o">/</span><span class="n">script</span><span class="o">/</span><span class="n">make_convolution</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>When executed, the following file <code class="docutils literal notranslate"><span class="pre">convolution.txt</span></code> will be created.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.500000</span> <span class="mf">0.010818010</span>
<span class="mf">0.600000</span> <span class="mf">0.013986716</span>
<span class="mf">0.700000</span> <span class="mf">0.016119093</span>
<span class="mf">0.800000</span> <span class="mf">0.017039022</span>
<span class="mf">0.900000</span> <span class="mf">0.017084666</span>
  <span class="o">...</span> <span class="n">skipped</span> <span class="o">...</span>
<span class="mf">5.600000</span> <span class="mf">0.000728539</span>
<span class="mf">5.700000</span> <span class="mf">0.000530758</span>
<span class="mf">5.800000</span> <span class="mf">0.000412908</span>
<span class="mf">5.900000</span> <span class="mf">0.000341740</span>
<span class="mf">6.000000</span> <span class="mf">0.000277553</span>
</pre></div>
</div>
<p>The first column is the viewing angle, and the second column is the normalized 00-peak diffraction intensity data
written in <code class="docutils literal notranslate"><span class="pre">surf-bulkP.s</span></code> with a convolution of half-width 0.5.</p>
</section>
</section>


      </div>
      <div class="bottomnav" role="navigation" aria-label="Bottom">
      
        <p>
        «&#160;&#160;<a href="index.html">Tutorials</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="minsearch.html">Optimization by Nelder-Mead method</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
    &#169; Copyright 2020, Institute for Solid State Physics, University of Tokyo.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    </div>
  </body>
</html>