<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Replica exchange Monte Carlo exchange &#8212; 2DMAT 2.3-dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/haiku.css?v=dfa0e015" />
    <script src="../_static/documentation_options.js?v=4e4c84c2"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Population Annealing Monte Carlo pamc" href="pamc.html" />
    <link rel="prev" title="Direct parallel search mapper" href="mapper_mpi.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="../index.html">
          <span>2DMAT 2.3-dev documentation</span></a></h1>
        <h2 class="heading"><span>Replica exchange Monte Carlo exchange</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="mapper_mpi.html">Direct parallel search <code class="docutils literal notranslate"><span class="pre">mapper</span></code></a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="pamc.html">Population Annealing Monte Carlo <code class="docutils literal notranslate"><span class="pre">pamc</span></code></a>&#160;&#160;»
        </p>

      </div>
      <div class="content" role="main">
        
        
  <section id="replica-exchange-monte-carlo-exchange">
<h1>Replica exchange Monte Carlo <code class="docutils literal notranslate"><span class="pre">exchange</span></code><a class="headerlink" href="#replica-exchange-monte-carlo-exchange" title="Link to this heading">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">exchange</span></code> explores the parameter space by using the replica exchange Monte Carlo (RXMC) method.</p>
<section id="preparation">
<h2>Preparation<a class="headerlink" href="#preparation" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://mpi4py.readthedocs.io/en/stable/">mpi4py</a> should be installed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">mpi4py</span>
</pre></div>
</div>
</section>
<section id="input-parameters">
<h2>Input parameters<a class="headerlink" href="#input-parameters" title="Link to this heading">¶</a></h2>
<p>This has two subsections <code class="docutils literal notranslate"><span class="pre">algorithm.param</span></code> and <code class="docutils literal notranslate"><span class="pre">algorithm.exchange</span></code> .</p>
<section id="algorithm-param">
<h3>[<code class="docutils literal notranslate"><span class="pre">algorithm.param</span></code>]<a class="headerlink" href="#algorithm-param" title="Link to this heading">¶</a></h3>
<p>This defines a space to be explored.
When <code class="docutils literal notranslate"><span class="pre">mesh_path</span></code> key is defined the discrete space is used.
Otherwise, continuous space is used.</p>
<ul>
<li><p>Continuous space</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">initial_list</span></code></p>
<p>Format: List of float. Length should be equal to <code class="docutils literal notranslate"><span class="pre">dimension</span></code>.</p>
<p>Description: Initial value of parameters.
If not defined, these will be initialize randomly.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">unit_list</span></code></p>
<p>Format: List of float. Length should be equal to <code class="docutils literal notranslate"><span class="pre">dimension</span></code>.</p>
<p>Description: Unit length of each parameter.
<code class="docutils literal notranslate"><span class="pre">Algorithm</span></code> makes parameters dimensionless and normalized by dividing these by <code class="docutils literal notranslate"><span class="pre">unit_list</span></code>.
If not defined, each component will be 1.0.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">min_list</span></code></p>
<p>Format: List of float. Length should be equal to <code class="docutils literal notranslate"><span class="pre">dimension</span></code>.</p>
<dl class="simple">
<dt>Description: Minimum value of each parameter.</dt><dd><p>When a parameter falls below this value during the Monte Carlo search,
the solver is not evaluated and the value is considered infinite.</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_list</span></code></p>
<p>Format: List of float. Length should be equal to <code class="docutils literal notranslate"><span class="pre">dimension</span></code>.</p>
<dl class="simple">
<dt>Description: Maximum value of each parameter.</dt><dd><p>When a parameter exceeds this value during the Monte Carlo search,
the solver is not evaluated and the value is considered infinite.</p>
</dd>
</dl>
</li>
</ul>
</li>
<li><p>Discrete space</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">mesh_path</span></code></p>
<p>Format: string</p>
<p>Description: Path to the mesh definition file.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">neighborlist_path</span></code></p>
<p>Format: string</p>
<p>Description: Path to the neighborhood-list file.</p>
</li>
</ul>
</li>
</ul>
</section>
<section id="algorithm-exchange">
<h3>[<code class="docutils literal notranslate"><span class="pre">algorithm.exchange</span></code>]<a class="headerlink" href="#algorithm-exchange" title="Link to this heading">¶</a></h3>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">numsteps</span></code></p>
<p>Format: Integer</p>
<p>Description: The number of Monte Carlo steps.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">numsteps_exchange</span></code></p>
<p>Format: Integer</p>
<p>Description: The number of interval Monte Carlo steps between replica exchange.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Tmin</span></code></p>
<p>Format: Float</p>
<p>Description: The minimum value of the “temperature” (<span class="math notranslate nohighlight">\(T\)</span>).</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Tmax</span></code></p>
<p>Format: Float</p>
<p>Description: The maximum value of the “temperature” (<span class="math notranslate nohighlight">\(T\)</span>).</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">bmin</span></code></p>
<p>Format: Float</p>
<p>Description: The minimum value of the “inverse temperature” (<span class="math notranslate nohighlight">\(\beta = 1/T\)</span>).
One of the “temperature” and “inverse temperature” should be defined.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">bmax</span></code></p>
<p>Format: Float</p>
<p>Description: The maximum value of the “inverse temperature” (<span class="math notranslate nohighlight">\(\beta = 1/T\)</span>).
One of the “temperature” and “inverse temperature” should be defined.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Tlogspace</span></code></p>
<p>Format: Boolean (default: true)</p>
<p>Description: Whether to assign “temperature” to replicas equally spaced in the logarithmic space or not.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">nreplica_per_proc</span></code></p>
<p>Format: Integer (default: 1)</p>
<p>Description: The number of replicas in a MPI process.</p>
</li>
</ul>
</section>
</section>
<section id="reference-file">
<h2>Reference file<a class="headerlink" href="#reference-file" title="Link to this heading">¶</a></h2>
<section id="mesh-definition-file">
<h3>Mesh definition file<a class="headerlink" href="#mesh-definition-file" title="Link to this heading">¶</a></h3>
<p>Define the grid space to be explored in this file.
The first column is the index of the mesh, and the second and subsequent columns are the values of variables.
Note that the index of the mesh will be ignored for this “algorithm”.</p>
<p>Below, a sample file is shown.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="mf">6.000000</span> <span class="mf">6.000000</span>
<span class="mi">2</span> <span class="mf">6.000000</span> <span class="mf">5.750000</span>
<span class="mi">3</span> <span class="mf">6.000000</span> <span class="mf">5.500000</span>
<span class="mi">4</span> <span class="mf">6.000000</span> <span class="mf">5.250000</span>
<span class="mi">5</span> <span class="mf">6.000000</span> <span class="mf">5.000000</span>
<span class="mi">6</span> <span class="mf">6.000000</span> <span class="mf">4.750000</span>
<span class="mi">7</span> <span class="mf">6.000000</span> <span class="mf">4.500000</span>
<span class="mi">8</span> <span class="mf">6.000000</span> <span class="mf">4.250000</span>
<span class="mi">9</span> <span class="mf">6.000000</span> <span class="mf">4.000000</span>
<span class="o">...</span>
</pre></div>
</div>
</section>
<section id="neighborhood-list-file">
<h3>Neighborhood-list file<a class="headerlink" href="#neighborhood-list-file" title="Link to this heading">¶</a></h3>
<p>Before searching in the discrete space by Markov Chain Monte Carlo method,
we should define “neighborhoods” for each point <span class="math notranslate nohighlight">\(i\)</span>, which are points that a walker can move from <span class="math notranslate nohighlight">\(i\)</span>
A neighborhood-list file defines the list of neighborhoods.
In this file, the index of an initial point <span class="math notranslate nohighlight">\(i\)</span> is specified by the first column,
and the indices of final points <span class="math notranslate nohighlight">\(j\)</span> are specified by the second and successive columns.</p>
<p>An utility tool, <code class="docutils literal notranslate"><span class="pre">py2dmat_neighborlist</span></code> is available for generating a neighborhood-list file from a mesh file. For details, please see <a class="reference internal" href="../tool.html"><span class="doc">Related Tools</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span>
<span class="mi">1</span> <span class="mi">0</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span>
<span class="mi">2</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span>
<span class="mi">3</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span>
<span class="mi">4</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span>
<span class="mi">5</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span>
<span class="o">...</span>
</pre></div>
</div>
</section>
</section>
<section id="output-files">
<h2>Output files<a class="headerlink" href="#output-files" title="Link to this heading">¶</a></h2>
<section id="rank-trial-txt">
<h3><code class="docutils literal notranslate"><span class="pre">RANK/trial.txt</span></code><a class="headerlink" href="#rank-trial-txt" title="Link to this heading">¶</a></h3>
<p>This file stores the suggested parameters and the corresponding value returned from the solver for each replica.
The first column is the index of the MC step.
The second column is the index of the walker in the process.
The third column is the temperature of the replica.
The fourth column is the value of the solver.
The remaining columns are the coordinates.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># step walker T fx z1 z2</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mf">0.004999999999999999</span> <span class="mf">0.07830821484593968</span> <span class="mf">3.682008067401509</span> <span class="mf">3.9502750191292586</span>
<span class="mi">1</span> <span class="mi">0</span> <span class="mf">0.004999999999999999</span> <span class="mf">0.0758494287185766</span> <span class="mf">2.811346329442423</span> <span class="mf">3.691101784194861</span>
<span class="mi">2</span> <span class="mi">0</span> <span class="mf">0.004999999999999999</span> <span class="mf">0.08566823949124412</span> <span class="mf">3.606664760390988</span> <span class="mf">3.2093903670436497</span>
<span class="mi">3</span> <span class="mi">0</span> <span class="mf">0.004999999999999999</span> <span class="mf">0.06273922648753057</span> <span class="mf">4.330900869594549</span> <span class="mf">4.311333132184154</span>
</pre></div>
</div>
</section>
<section id="rank-result-txt">
<h3><code class="docutils literal notranslate"><span class="pre">RANK/result.txt</span></code><a class="headerlink" href="#rank-result-txt" title="Link to this heading">¶</a></h3>
<p>This file stores the sampled parameters and the corresponding value returned from the solver for each replica.
This has the same format as <code class="docutils literal notranslate"><span class="pre">trial.txt</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># step walker T fx z1 z2</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mf">0.004999999999999999</span> <span class="mf">0.07830821484593968</span> <span class="mf">3.682008067401509</span> <span class="mf">3.9502750191292586</span>
<span class="mi">1</span> <span class="mi">0</span> <span class="mf">0.004999999999999999</span> <span class="mf">0.07830821484593968</span> <span class="mf">3.682008067401509</span> <span class="mf">3.9502750191292586</span>
<span class="mi">2</span> <span class="mi">0</span> <span class="mf">0.004999999999999999</span> <span class="mf">0.07830821484593968</span> <span class="mf">3.682008067401509</span> <span class="mf">3.9502750191292586</span>
<span class="mi">3</span> <span class="mi">0</span> <span class="mf">0.004999999999999999</span> <span class="mf">0.06273922648753057</span> <span class="mf">4.330900869594549</span> <span class="mf">4.311333132184154</span>
</pre></div>
</div>
</section>
<section id="best-result-txt">
<h3><code class="docutils literal notranslate"><span class="pre">best_result.txt</span></code><a class="headerlink" href="#best-result-txt" title="Link to this heading">¶</a></h3>
<p>The optimal value of the solver and the corresponding parameter among the all samples.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nprocs</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">rank</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">step</span> <span class="o">=</span> <span class="mi">65</span>
<span class="n">fx</span> <span class="o">=</span> <span class="mf">0.008233957976993406</span>
<span class="n">z1</span> <span class="o">=</span> <span class="mf">4.221129370933539</span>
<span class="n">z2</span> <span class="o">=</span> <span class="mf">5.139591716517661</span>
</pre></div>
</div>
</section>
<section id="result-t-txt">
<h3><code class="docutils literal notranslate"><span class="pre">result_T#.txt</span></code><a class="headerlink" href="#result-t-txt" title="Link to this heading">¶</a></h3>
<p>This file stores samples for each temperature ( <code class="docutils literal notranslate"><span class="pre">#</span></code> is replaced with the index of temperature ).
The first column is the index of the MC step.
The second column is the index of the walker.
The third column is the value of the solver.
The remaining columns are the coordinates.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># T = 1.0</span>
<span class="mi">0</span> <span class="mi">15</span> <span class="mf">28.70157662892569</span> <span class="mf">3.3139009347685118</span> <span class="o">-</span><span class="mf">4.20946994566609</span>
<span class="mi">1</span> <span class="mi">15</span> <span class="mf">28.70157662892569</span> <span class="mf">3.3139009347685118</span> <span class="o">-</span><span class="mf">4.20946994566609</span>
<span class="mi">2</span> <span class="mi">15</span> <span class="mf">28.70157662892569</span> <span class="mf">3.3139009347685118</span> <span class="o">-</span><span class="mf">4.20946994566609</span>
<span class="mi">3</span> <span class="mi">15</span> <span class="mf">28.98676409223712</span> <span class="mf">3.7442621319489637</span> <span class="o">-</span><span class="mf">3.868754990884034</span>
</pre></div>
</div>
<section id="algorithm">
<h4>Algorithm<a class="headerlink" href="#algorithm" title="Link to this heading">¶</a></h4>
</section>
</section>
</section>
<section id="markov-chain-monte-carlo">
<h2>Markov chain Monte Carlo<a class="headerlink" href="#markov-chain-monte-carlo" title="Link to this heading">¶</a></h2>
<p>The Markov chain Monte Carlo (MCMC) sampling explores the parameter space by moving walkers <span class="math notranslate nohighlight">\(\vec{x}\)</span> stochastically according to the weight function <span class="math notranslate nohighlight">\(W(\vec{x})\)</span>.
For the weight function, the Boltzmann factor <span class="math notranslate nohighlight">\(W(\vec{x}) = e^{-f(\vec{x})/T}\)</span> is generally adopted, where <span class="math notranslate nohighlight">\(T&gt;0\)</span> is the “temperature.”
It is impossible in the many cases, unfortunately, to sample walkers according to <span class="math notranslate nohighlight">\(W\)</span> directly.
Insteadly, the MCMC method moves walkers slightly and generates a time series <span class="math notranslate nohighlight">\(\{\vec{x}_t\}\)</span> such that the distribution of the walkers obeys <span class="math notranslate nohighlight">\(W\)</span> .
Let us call the transision probability from <span class="math notranslate nohighlight">\(\vec{x}\)</span> to <span class="math notranslate nohighlight">\(\vec{x}'\)</span> as <span class="math notranslate nohighlight">\(p(\vec{x}' | \vec{x})\)</span>.
When <span class="math notranslate nohighlight">\(p\)</span> is determined by the following condition (“the balance condition”)</p>
<div class="math notranslate nohighlight">
\[W(\vec{x}') = \sum_{\vec{x}} p(\vec{x}' | \vec{x}) W(\vec{x}),\]</div>
<p>the distribution of the generated time series <span class="math notranslate nohighlight">\(\{\vec{x}_t\}\)</span> will converges to <span class="math notranslate nohighlight">\(W(\vec{x})\)</span> <a class="footnote-reference brackets" href="#mcmc-condition" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.
Practically, the stronger condition (“the detailed balance condition”)</p>
<div class="math notranslate nohighlight">
\[p(\vec{x} | \vec{x}') W(\vec{x}') =  W(\vec{x})p(\vec{x}' | \vec{x})\]</div>
<p>is usually imposed.
The detailed balance condition returns to the balance condition by taking the summation of <span class="math notranslate nohighlight">\(\vec{x}\)</span>.</p>
<p>2DMAT adopts the Metropolis-Hasting (MH) method for solving the detailed balance condition.
The MH method splits the transition process into the suggestion process and the acceptance process.</p>
<ol class="arabic simple">
<li><p>Generate a candidate <span class="math notranslate nohighlight">\(\vec{x}\)</span> with the suggestion probability <span class="math notranslate nohighlight">\(P(\vec{x} | \vec{x}_t)\)</span>.</p>
<ul class="simple">
<li><p>As <span class="math notranslate nohighlight">\(P\)</span>, use a simple distribution such as the normal distribution with centered at x.</p></li>
</ul>
</li>
<li><p>Accept the candidate <span class="math notranslate nohighlight">\(\vec{x}\)</span> with the acceptance probability <span class="math notranslate nohighlight">\(Q(\vec{x} | \vec{x}_t)\)</span>.</p>
<ul class="simple">
<li><p>If accepted, let <span class="math notranslate nohighlight">\(\vec{x}_{t+1}\)</span> be <cite>vec{x}</cite>.</p></li>
<li><p>Otherwise, let <span class="math notranslate nohighlight">\(\vec{x}_{t+1}\)</span> be <cite>vec{x}_t</cite>.</p></li>
</ul>
</li>
</ol>
<p>The whole transision probability is the product of these two ones, <span class="math notranslate nohighlight">\(p(\vec{x} | \vec{x_t}) = P(\vec{x} | \vec{x}_t) Q(\vec{x} | \vec{x}_t)\)</span>.
The acceptance probability <span class="math notranslate nohighlight">\(Q(\vec{x} | \vec{x}_t)\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[Q(\vec{x} | \vec{x}_t) = \min\left[1, \frac{W(\vec{x})P(\vec{x}_t | \vec{x}) }{W(\vec{x}_t) P(\vec{x} | \vec{x}_t)} \right].\]</div>
<p>It is easy to verify that the detailed balance condition is satisfied by substituting it into the detailed balance condition equation.</p>
<p>When adopting the Boltzmann factor for the weight and a symmetry distribution
<span class="math notranslate nohighlight">\(P(\vec{x} | \vec{x}_t) = P(\vec{x}_t | \vec{x})\)</span> for the suggestion probability,
the acceptance probability <span class="math notranslate nohighlight">\(Q\)</span> will be the following simple form:</p>
<div class="math notranslate nohighlight">
\[Q(\vec{x} | \vec{x}_t) = \min\left[1, \frac{W(\vec{x})}{W(\vec{x}_t)} \right]
                       = \min\left[1, \exp\left(-\frac{f(\vec{x}) - f(\vec{x}_t)}{T}\right) \right].\]</div>
<p>By saying <span class="math notranslate nohighlight">\(\Delta f = f(\vec{x}) - f(\vec{x}_t)\)</span> and using the fact <span class="math notranslate nohighlight">\(Q=1\)</span> for <span class="math notranslate nohighlight">\(\Delta f \le 0\)</span>,
the procedure of MCMC with the MH algorithm is the following:</p>
<ol class="arabic simple">
<li><p>Choose a candidate from near the current position and calculate <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(\Delta f\)</span>.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(\Delta f \le 0\)</span>, that is, the walker is descending, accept it.</p></li>
<li><p>Otherwise, accept it with the probability <span class="math notranslate nohighlight">\(Q=e^{-\Delta f/T}\)</span>.</p></li>
<li><p>Repeat 1-3.</p></li>
</ol>
<p>The solution is given as the point giving the minimum value of <span class="math notranslate nohighlight">\(f(\vec{x})\)</span>.
The third process of the above procedure endures that walkers can climb over the hill with a height of <span class="math notranslate nohighlight">\(\Delta f \sim T\)</span>, the MCMC sampling can escape from local minima.</p>
</section>
<section id="replica-exchange-monte-carlo">
<h2>Replica exchange Monte Carlo<a class="headerlink" href="#replica-exchange-monte-carlo" title="Link to this heading">¶</a></h2>
<p>The “temperature” <span class="math notranslate nohighlight">\(T\)</span> is one of the most important hyper parameters in the MCMC sampling.
The MCMC sampling can climb over the hill with a height of <span class="math notranslate nohighlight">\(T\)</span> but cannot easily escape from the deeper valley than <span class="math notranslate nohighlight">\(T\)</span>.
It is why we should increase the temperature in order to avoid stuck to local minima.
On the other hand, since walkers cannot see the smaller valleys than <span class="math notranslate nohighlight">\(T\)</span>, the precision of the obtained result <span class="math notranslate nohighlight">\(\min f(\vec{x})\)</span> becomes about <span class="math notranslate nohighlight">\(T\)</span>, and it is necessary to decrease the temperature in order to achieve more precise result.
This dilemma leads us that we should tune the temperature carefully.</p>
<p>One of the ways to overcome this problem is to update temperature too.
For example, simulated annealing decreases temperature as the iteration goes.
Another algorithm, simulated tempering, treats temperature as another parameter to be sampled, not a fixed hyper parameter,
and update temperature after some iterations according to the (detailed) balance condition.
Simulated tempering studies the details of a valley by cooling and escapes from a valley by heating.
Replica exchange Monte Carlo (RXMC), also known as parallel tempering, is a parallelized version of the simulated tempering.
In this algorithm, several copies of a system with different temperature, called as replicas, will be simulated in parallel.
Then, with some interval of steps, each replica exchanges temperature with another one according to the (detailed) balance condition.
As the simulated tempering does, RXMC can observe the details of a valley and escape from it by cooling and heating.
Moreover, because each temperature is assigned to just one replica, the temperature distribution will not be biased.
Using more replicas narrows the temperature interval, and increases the acceptance ratio of the temperature exchange.
This is why this algorithm suits for the massively parallel calculation.</p>
<p>It is recommended that users perform <code class="docutils literal notranslate"><span class="pre">minsearch</span></code> optimization starting from the result of <code class="docutils literal notranslate"><span class="pre">exchange</span></code>, because the RXMC result has uncertainty due to temperature.</p>
<p class="rubric">footnote</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="mcmc-condition" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>To be precisely, the non-periodicality and the ergodicity are necessary for convergence.</p>
</aside>
</aside>
</section>
</section>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="mapper_mpi.html">Direct parallel search <code class="docutils literal notranslate"><span class="pre">mapper</span></code></a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="pamc.html">Population Annealing Monte Carlo <code class="docutils literal notranslate"><span class="pre">pamc</span></code></a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
    &#169; Copyright 2020, Institute for Solid State Physics, University of Tokyo.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    </div>
  </body>
</html>