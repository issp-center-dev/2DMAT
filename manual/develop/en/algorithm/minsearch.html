<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Nelder-Mead method minsearch &#8212; 2DMAT 2.2.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/haiku.css?v=dfa0e015" />
    <script src="../_static/documentation_options.js?v=b21de401"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Direct parallel search mapper" href="mapper_mpi.html" />
    <link rel="prev" title="Search algorithms" href="index.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="../index.html">
          <span>2DMAT 2.2.0 documentation</span></a></h1>
        <h2 class="heading"><span>Nelder-Mead method minsearch</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="index.html">Search algorithms</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="mapper_mpi.html">Direct parallel search <code class="docutils literal notranslate"><span class="pre">mapper</span></code></a>&#160;&#160;»
        </p>

      </div>
      <div class="content" role="main">
        
        
  <section id="nelder-mead-method-minsearch">
<h1>Nelder-Mead method <code class="docutils literal notranslate"><span class="pre">minsearch</span></code><a class="headerlink" href="#nelder-mead-method-minsearch" title="Link to this heading">¶</a></h1>
<p>When <code class="docutils literal notranslate"><span class="pre">minsearch</span></code> is selcted, the optimization by the <a class="reference external" href="https://en.wikipedia.org/wiki/Nelder%E2%80%93Mead_method">Nelder-Mead method</a> (a.k.a. downhill simplex method) will be done. In the Nelder-Mead method, the dimension of the parameter space is <span class="math notranslate nohighlight">\(D\)</span>, and the optimal solution is searched by systematically moving pairs of <span class="math notranslate nohighlight">\(D+1\)</span> coordinate points according to the value of the objective function at each point.</p>
<p>An important hyperparameter is the initial value of the coordinates.
Although it is more stable than the simple steepest descent method, it still has the problem of being trapped in the local optimum solution, so it is recommended to repeat the calculation with different initial values several times to check the results.</p>
<p>In 2DMAT, the Scipy’s function <code class="docutils literal notranslate"><span class="pre">scipy.optimize.minimize(method=&quot;Nelder-Mead&quot;)</span></code> is used.
For details, see <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize">the official document</a> .</p>
<section id="preparation">
<h2>Preparation<a class="headerlink" href="#preparation" title="Link to this heading">¶</a></h2>
<p>You will need to install <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference">scipy</a> .:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">scipy</span>
</pre></div>
</div>
</section>
<section id="input-parameters">
<h2>Input parameters<a class="headerlink" href="#input-parameters" title="Link to this heading">¶</a></h2>
<p>It has subsections <code class="docutils literal notranslate"><span class="pre">param</span></code> and <code class="docutils literal notranslate"><span class="pre">minimize</span></code>.</p>
<section id="param-section">
<span id="minsearch-input-param"></span><h3>[<code class="docutils literal notranslate"><span class="pre">param</span></code>] section<a class="headerlink" href="#param-section" title="Link to this heading">¶</a></h3>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">initial_list</span></code></p>
<p>Format: List of float. The length should match the value of dimension.</p>
<p>Description: Initial value of the parameter. If not defined, it will be initialized uniformly and randomly.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">unit_list</span></code></p>
<p>Format: List of float. The length should match the value of dimension.</p>
<dl class="simple">
<dt>Description: Units for each parameter.</dt><dd><p>In the search algorithm, each parameter is divided by each of these values to perform a simple dimensionless and normalization.
If not defined, the value is 1.0 for all dimensions.</p>
</dd>
</dl>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">min_list</span></code></p>
<p>Format: List of float. Length should be equal to <code class="docutils literal notranslate"><span class="pre">dimension</span></code>.</p>
<dl class="simple">
<dt>Description: Minimum value of each parameter.</dt><dd><p>When a parameter falls below this value during the Nelson-Mead method,
the solver is not evaluated and the value is considered infinite.</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_list</span></code></p>
<p>Format: List of float. Length should be equal to <code class="docutils literal notranslate"><span class="pre">dimension</span></code>.</p>
<dl class="simple">
<dt>Description: Maximum value of each parameter.</dt><dd><p>When a parameter exceeds this value during the Nelson-Mead method,
the solver is not evaluated and the value is considered infinite.</p>
</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
<section id="minimize-section">
<h3>[<code class="docutils literal notranslate"><span class="pre">minimize</span></code>] section<a class="headerlink" href="#minimize-section" title="Link to this heading">¶</a></h3>
<p>Set the hyperparameters for the Nelder-Mead method.
See the documentation of <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.minimize-neldermead.html">scipy.optimize.minimize</a> for details.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">initial_scale_list</span></code></p>
<p>Format: List of float. The length should match the value of dimension.</p>
<p>Description: The difference value that is shifted from the initial value in order to create the initial simplex for the Nelder-Mead method.
The <code class="docutils literal notranslate"><span class="pre">initial_simplex</span></code> is given by the sum of <code class="docutils literal notranslate"><span class="pre">initial_list</span></code> and the dimension of the <code class="docutils literal notranslate"><span class="pre">initial_list</span></code> plus one component of the <code class="docutils literal notranslate"><span class="pre">initial_scale_list</span></code>.
If not defined, scales at each dimension are set to 0.25.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">xatol</span></code></p>
<p>Format: Float (default: 1e-4)</p>
<p>Description: Parameters used to determine convergence of the Nelder-Mead method.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">fatol</span></code></p>
<p>Format: Float (default: 1e-4)</p>
<p>Description: Parameters used to determine convergence of the Nelder-Mead method.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">maxiter</span></code></p>
<p>Format: Integer (default: 10000)</p>
<p>Description: Maximum number of iterations for the Nelder-Mead method.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">maxfev</span></code></p>
<p>Format: Integer (default: 100000)</p>
<p>Description: Maximum number of times to evaluate the objective function.</p>
</li>
</ul>
</section>
</section>
<section id="output-files">
<h2>Output files<a class="headerlink" href="#output-files" title="Link to this heading">¶</a></h2>
<section id="simplexdata-txt">
<h3><code class="docutils literal notranslate"><span class="pre">SimplexData.txt</span></code><a class="headerlink" href="#simplexdata-txt" title="Link to this heading">¶</a></h3>
<p>Outputs information about the process of finding the minimum value.
The first line is a header, the second and subsequent lines are step,
the values of variables defined in <code class="docutils literal notranslate"><span class="pre">string_list</span></code> in the <code class="docutils literal notranslate"><span class="pre">[solver]</span></code> - <code class="docutils literal notranslate"><span class="pre">[param]</span></code> sections of the input file,
and finally the value of the function.</p>
<p>The following is an example of the output.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#step z1 z2 z3 R-factor</span>
<span class="mi">0</span> <span class="mf">5.25</span> <span class="mf">4.25</span> <span class="mf">3.5</span> <span class="mf">0.015199251773721183</span>
<span class="mi">1</span> <span class="mf">5.25</span> <span class="mf">4.25</span> <span class="mf">3.5</span> <span class="mf">0.015199251773721183</span>
<span class="mi">2</span> <span class="mf">5.229166666666666</span> <span class="mf">4.3125</span> <span class="mf">3.645833333333333</span> <span class="mf">0.013702918021532375</span>
<span class="mi">3</span> <span class="mf">5.225694444444445</span> <span class="mf">4.40625</span> <span class="mf">3.5451388888888884</span> <span class="mf">0.012635279378225261</span>
<span class="mi">4</span> <span class="mf">5.179976851851851</span> <span class="mf">4.348958333333334</span> <span class="mf">3.5943287037037033</span> <span class="mf">0.006001660077530159</span>
<span class="mi">5</span> <span class="mf">5.179976851851851</span> <span class="mf">4.348958333333334</span> <span class="mf">3.5943287037037033</span> <span class="mf">0.006001660077530159</span>
</pre></div>
</div>
</section>
<section id="res-txt">
<h3><code class="docutils literal notranslate"><span class="pre">res.txt</span></code><a class="headerlink" href="#res-txt" title="Link to this heading">¶</a></h3>
<p>The value of the final objective function and the value of the parameters at that time are described.
The objective function is listed first, followed by the values of the variables defined in <code class="docutils literal notranslate"><span class="pre">string_list</span></code> in the <code class="docutils literal notranslate"><span class="pre">[solver]</span></code> - <code class="docutils literal notranslate"><span class="pre">[param]</span></code> sections of the input file, in that order.</p>
<p>The following is an example of the output.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fx</span> <span class="o">=</span> <span class="mf">7.382680568652868e-06</span>
<span class="n">z1</span> <span class="o">=</span> <span class="mf">5.230524973874179</span>
<span class="n">z2</span> <span class="o">=</span> <span class="mf">4.370622919269477</span>
<span class="n">z3</span> <span class="o">=</span> <span class="mf">3.5961444501081647</span>
</pre></div>
</div>
</section>
</section>
</section>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="index.html">Search algorithms</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="mapper_mpi.html">Direct parallel search <code class="docutils literal notranslate"><span class="pre">mapper</span></code></a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
    &#169; Copyright 2020, Institute for Solid State Physics, University of Tokyo.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    </div>
  </body>
</html>